"use strict";!function(){const e={conversionType:"conversion_type"},t="none",n="chrome_90_api",o="chrome_92_api";function i(e){return{[n]:"".concat("https://cm.teads.tv","/conversion"),[o]:"".concat("https://cm.teads.tv","/v2/conversion")}[e]||null}function a(e){let t="";const n=function(e){let t=e,n=!1;try{for(let e=0;t.parent.document!==t.document||e<50;e+=1){if(!t.parent.document){n=!0;break}t=t.parent}}catch(e){n=!0}return{topFrame:t,err:n}}(e),{topFrame:o}=n;if(n.err)try{t=o.top.location.href}catch(e){t=o.location.href}else t=o.location.href;return t}function c(e,t){try{const n={errorMessage:e,topUrl:a(window),userAgent:void 0!==window.navigator&&void 0!==window.navigator.userAgent?window.navigator.userAgent:"",exception:t||""};e=JSON.stringify(n)}catch(e){}document.createElement("img").src="".concat("https://l.teads.tv/performance/http-source","?").concat(encodeURIComponent(e))}function r(e){const t=document.createElement("img");t.width=0,t.height=0,t.alt="",t.style.position="absolute",t.src=e,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.getElementsByTagName("script")[0].parentNode).insertBefore(t,null)}async function d(e,t,n){const o=l(),i=m(),r=await async function(){try{return _()&&((e=document.interestCohort)&&"function"==typeof e&&"[object Function]"===Object.prototype.toString.call(e))&&await document.interestCohort()||{}}catch(e){return c(" Unable to retrieve interest cohort data",e.message),{}}var e}(),d=function(e){const t=[];return Object.keys(e).forEach(n=>{t.push("".concat(n,"=").concat(encodeURIComponent(e[n])))}),t.join("&")}(t);let s=a(window);s=function(e){const t=["account","password","pass","secret","secretkey","username","user","login","ordernumber","orderid","email","mail","user.email","user.password","user.name","user.mail","user.lastname","user.firstname","user.phone","user.phonenumber","lastname","firstname","name","address","phonenumber","phone","client_secret","guid"];let n;if(""!==e){const o=e.split("?").length>1?e.split("?")[1]:void 0;if(void 0!==o){let i="".concat(e.split("?")[0],"?");const a=o.split("&");for(let e=0;e<a.length;e+=1){const o=a[e];-1!==o.indexOf("auctid=")&&(n=o.replace("auctid=",""));const c=o.split(/=(.+)/);i="".concat(i+(0===e?"":"&")+c[0],"=").concat(t.indexOf(c[0])>=0?"XXXXXXXX":c[1])}e=i}}return{auctionId:n,sanitizedValue:e}}(s);let u="".concat(n,"?action=").concat(e,"&env=js-web&pixel_version=").concat(encodeURIComponent("1.0.0"));return d.length>0&&(u="".concat(u,"&").concat(d)),void 0!==i?u="".concat(u,"&buyer_pixel_id=").concat(encodeURIComponent(i)):void 0!==o&&(u="".concat(u,"&advertiser_id=").concat(encodeURIComponent(o))),r.id&&(u="".concat(u,"&cohort_id=").concat(encodeURIComponent(r.id))),r.version&&(u="".concat(u,"&cohort_version=").concat(encodeURIComponent(r.version))),u="".concat(u,"&referer=").concat(encodeURIComponent(s.sanitizedValue)),void 0!==s.auctionId&&s.auctionId.length>0&&(u="".concat(u,"&").concat("auctid=").concat(s.auctionId)),u}function s(t,n){const o={};return Object.keys(t).forEach(i=>{const a=i,r=t[i];Object.prototype.hasOwnProperty.call(e,a)?o[e[a]]=r+(n||""):c("Invalid parameter specified in event: ".concat(a))}),o}async function u(){v(),function(){const e=document.createElement("meta");e.httpEquiv="origin-trial",e.content="A/j6QtZ5QtlZcLGHuYBce5i3WFMXVvc89MjxJazvAJx/Vk5s4X8XcCtbAFmv8NFM084EjqJGNfn99gg0FUhvIgYAAAB6eyJvcmlnaW4iOiJodHRwczovL3RlYWRzLnR2OjQ0MyIsImZlYXR1cmUiOiJJbnRlcmVzdENvaG9ydEFQSSIsImV4cGlyeSI6MTYyNjIyMDc5OSwiaXNTdWJkb21haW4iOnRydWUsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0=",document.head.appendChild(e)}();try{window.teads_disable_time_on_site_tracking||Object.defineProperty(window,"teads_disable_time_on_site_tracking",{set(e){this._teads_disable_time_on_site_tracking=e},get(){return this._teads_disable_time_on_site_tracking},configurable:!0}),window.teads_adv_id||Object.defineProperty(window,"teads_adv_id",{set(e){this._teads_adv_id=e,w()},get(){return this._teads_adv_id},configurable:!0}),window.teads_buyer_pixel_id||Object.defineProperty(window,"teads_buyer_pixel_id",{set(e){this._teads_buyer_pixel_id=e,w()},get(){return this._teads_buyer_pixel_id},configurable:!0})}catch(e){c("Error while binding advertiser and pixel ids",e.message)}const e=l(),t=m();"number"!=typeof e&&"number"!=typeof t||await w();const n=window.teads_e||[];window.teads_e=[],window.teads_e.push=function(...e){return Array.prototype.push.apply(this,e),async function(){if(void 0!==window.teads_e){const e=[];for(;window.teads_e.length;)e.push(p(window.teads_e.shift()));await Promise.all(e)}else c("The event queue is not defined.")}(),window.teads_e.length},window.teads_e.push(...n)}function l(){if(void 0!==window.teads&&void 0!==window.teads.advertiserId){if("number"==typeof window.teads.advertiserId)return window.teads.advertiserId;c("The format of AdvertiserId is not valid.")}else{if(void 0===window.teads_cv||void 0===window.teads_cv.advertiserId)return window.teads_adv_id;if("number"==typeof window.teads_cv.advertiserId)return window.teads_cv.advertiserId;c("The format of AdvertiserId is not valid.")}}function m(){return window.teads_buyer_pixel_id}async function p(e){r(await d("conversion",s(e),"https://t.teads.tv/track"));const t=i(f());if(t){r(await d("conversion",s(e),t))}}async function w(){r(await d("pageView",{},"https://t.teads.tv/track"));const e=i(f());if(e){r(await d("pageView",{},e))}if(!window.teads_disable_time_on_site_tracking){let e=!1;const t=await d("timeSpent",{},"https://t.teads.tv/track");document.addEventListener("visibilitychange",()=>{"hidden"!==document.visibilityState||e||(e=!0,function(e){navigator&&navigator.sendBeacon&&navigator.sendBeacon(e)||r(e)}(t))})}}function f(){const e=!!document.featurePolicy&&!!document.featurePolicy.features();return _()&&e&&document.featurePolicy.features().includes("conversion-measurement")?n:_()&&e&&document.featurePolicy.features().includes("attribution-reporting")?o:t}function v(){const e=document.createElement("meta");e.httpEquiv="origin-trial",e.content="AzTuVo+9bDhP/SV2p62tu1vYU8B9NU0J4A6+P2YzM59LlLVIvTljSKPaa3V0+4EejDULlOLmBVA2zQq+XUDoWQ4AAAB+eyJvcmlnaW4iOiJodHRwczovL3RlYWRzLnR2OjQ0MyIsImZlYXR1cmUiOiJDb252ZXJzaW9uTWVhc3VyZW1lbnQiLCJleHBpcnkiOjE2MzE2NjM5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9",document.head.appendChild(e)}function _(){return!!window.chrome}async function h(e){try{"undefined"!=typeof window&&(e>0&&void 0===window.teads_cv?setTimeout(u,e):await u())}catch(e){c("Unhandled exception",e.message)}}h(200),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports.tag=h,module.exports.getTopUrl=a,module.exports.setConversionMeasurementTrialToken=v)}();